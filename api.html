<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Joke API</title>
<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

<!-- STYLE -->
<style type="text/css">
	#header{
		text-align: center;
		margin: auto;
		line-height: 1.5;
		font-family: "Helvetica";
	}
	#body{
		text-align: center;
		font-family: "Helvetica";
		background-color: #ebedf0;
		line-height: 3;
		font-size: 25px;
	}
</style>
</head>

<!-- SCRIPT BEGINS HERE -->
<script>
function requestJoke(){
	//CONSTRUCT
	var reqJoke = new XMLHttpRequest();
	if(!reqJoke){
		alert("Unable to retrieve joke.");
	}
	//OPEN
	reqJoke.open("GET", "https://v2.jokeapi.dev/joke/Any", true);
	
	//EVENT HANDLER
	reqJoke.onreadystatechange = function(){

		if(reqJoke.readyState==4  && reqJoke.status==200){
			var data = reqJoke.responseText;
			var info=JSON.parse(data);
			var type=info.type;
			var safe=info.type;
			var joke;
			if(type == "twopart"){
				joke = "" + info.setup + "\n\n\n" + info.delivery;
			}
			else{
				joke = info.joke;
			}
			if(info.safe==false){
				
				document.getElementById("jokepart1").innerHTML = "Sorry, the joke that loaded isn't labeled as safe. Please reload for a new joke!";
			}
			else{
				document.getElementById("jokepart1").innerHTML = joke;
			}
		}
		else{
			document.getElementById("jokepart1").innerHTML = "Oops! Something is wrong.";
		}
	}
	
	//SEND
	reqJoke.send();
}

</script>

<!-- BODY - where the joke will be. Calls requestJoke when it loads-->
<body id = "body" onload="requestJoke()">
	
<h1 id="header">Joke API</h1>
<div id="jokepart1">
	Joke Loading...
</div>


</body>
</html>